<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PetMarket - Marketplace Pet</title>
    <link rel="stylesheet" href="style.css">
</head>

<style>
 /* CONTAINER GERAL */
.produtos-container {
    max-width: 1300px;
    margin: 30px auto;
    padding: 0 20px;
}

.titulo-produtos {
    font-size: 2.2rem;
    font-weight: 700;
    text-align: center;
    margin-bottom: 30px;
    color: #222;
}

.produtos-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
    gap: 25px;
}

.produto {
    background: #fff;
    border-radius: 14px;
    overflow: hidden;
    border: 1px solid #e6e6e6;
    transition: transform .25s ease, box-shadow .25s ease;
    cursor: pointer;
}

.produto:hover {
    transform: translateY(-6px);
    box-shadow: 0 6px 20px rgba(0,0,0,0.12);
}

.produto img {
    width: 100%;
    height: 200px;
    object-fit: cover;
    background: #f7f7f7;
}

.produto-info {
    padding: 15px;
}

.produto-info h3 {
    font-size: 1rem;
    color: #333;
    font-weight: 600;
    height: 42px;
    line-height: 1.2;
    overflow: hidden;
    text-overflow: ellipsis;
    margin-bottom: 6px;
}

.preco {
    font-size: 1.4rem;
    color: #20bf6b;
    font-weight: 700;
    margin-bottom: 10px;
    display: block;
}

.btn-ver {
    display: block;
    width: 100%;
    text-align: center;
    background: #20bf6b;
    color: #fff;
    padding: 10px 0;
    border-radius: 10px;
    text-decoration: none;
    font-weight: 600;
    margin-top: 10px;
    transition: background .2s;
}

.btn-ver:hover {
    background: #17a65c;
}

.frete {
    font-size: .9rem;
    color: #00bb2d;
    font-weight: bold;
    margin-bottom: 5px;
}

.logouBtn {
    color: #00bb2d;
}
.carrinho {
    font-size: 22px; 
    margin-right: 20px; 
    cursor: pointer; 
    position:relative;
}
.numero-carrinho {
    background:red; 
    color:white; 
    font-size:12px; 
    padding:2px 6px; 
    border-radius:50%; 
    position:absolute; 
    top:-8px; 
    right:-12px;
}
@media (max-width: 480px) {
    .produto img {
        height: 160px;
    }
    .titulo-produtos {
        font-size: 1.8rem;
    }
}
</style>

<body>

    <!-- Navbar -->
    <header class="navbar">
        <div class="logo">üêæ PetMarket</div>
        <div>
            <span id="areaUsuario" style="display:none; font-weight:bold; color:rgb(0, 0, 0); margin-right:15px;">
                Usuario: <span id="nomeUsuario"></span>
                
            </span>
            
        </div>
        <nav>
            <a href="#">Home</a>
            <a href="produtos.html">Produtos</a>
            <a href="servico.html">Servi√ßos</a>
             <a href="carrinho.html" id="cart" class="carrinho">
                üõí
                <span id="cartCount" class="numero-carrinho">
                    0
                </span>
            </a>
            <button id="logoutBtn" class="btn-login">
            Sair
        </button>
            
            <!-- BOT√ÉO LOGIN (some quando logado) -->
            <a href="login_cliente.html" class="btn-login" id="btnLogin">Entrar</a>


            <!-- √çCONE DO CARRINHO -->
           
        </nav>
    </header>

    <!-- Banner -->
    <section class="hero">
        <h1>O marketplace ideal para cuidar do seu pet ‚ù§Ô∏è</h1>
        <p>Encontre petshops, agende servi√ßos e compre produtos em um s√≥ lugar.</p>
        
    </section>

    <!-- Categorias -->
    <section class="categorias">
        <h2>Categorias</h2>

        <div class="cards">
            <div class="card">
                <img src="https://cdn-icons-png.flaticon.com/512/194/194279.png" alt="">
                <h3>Servi√ßos</h3>
            </div>

            <div class="card">
                <img src="https://cdn-icons-png.flaticon.com/512/616/616408.png" alt="">
                <h3>Consultas Veterin√°rias</h3>
            </div>

            <div class="card">
                <img src="https://cdn-icons-png.flaticon.com/512/1998/1998611.png" alt="">
                <h3>Ra√ß√µes</h3>
            </div>

            <div class="card">
                <img src="https://cdn-icons-png.flaticon.com/512/6787/6787012.png" alt="">
                <h3>Acess√≥rios</h3>
            </div>
        </div>
    </section>

    <!-- Produtos -->
    <section class="produtos-container">
        <h2 class="titulo-produtos">Produtos em destaque</h2>

        <div class="produtos-grid" id="lista-produtos"></div>
    </section>

    <footer class="footer">
        <p>¬© 2025 PetMarket ‚Äî Todos os direitos reservados.</p>
    </footer>

<script>
// =========================
// üîπ CONTROLE DE LOGIN / LOGOUT
// =========================
const nomeCliente = localStorage.getItem("cliente_nome");
const areaUsuario = document.getElementById("areaUsuario");
const nomeUsuario = document.getElementById("nomeUsuario");
const btnLogin = document.getElementById("btnLogin");
const logoutBtn = document.getElementById("logoutBtn");

if (nomeCliente) {
    areaUsuario.style.display = "inline-block";
    nomeUsuario.textContent = nomeCliente;

    btnLogin.style.display = "none";
    logoutBtn.style.display = "inline-block";
} else {
    areaUsuario.style.display = "none"; 
    logoutBtn.style.display = "none"; 
    btnLogin.style.display = "inline-block";
}

logoutBtn.addEventListener("click", () => {
    localStorage.clear();
    window.location.reload();
});

// =========================
// üîπ CARRINHO
// =========================
async function atualizarCarrinho() {
    const token = localStorage.getItem("token_cliente");
    if (!token) {
        document.getElementById("cartCount").textContent = 0;
        return;
    }

    try {
        const res = await fetch("http://localhost:3000/carrinho", {
            headers: {
                "Authorization": "Bearer " + token
            }
        });
        const data = await res.json();

        if (res.ok) {
            // quantidade total de itens
            document.getElementById("cartCount").textContent = data.quantidade_itens;
        } else {
            document.getElementById("cartCount").textContent = 0;
        }

    } catch (err) {
        console.error("Erro ao atualizar carrinho:", err);
        document.getElementById("cartCount").textContent = 0;
    }
}
document.addEventListener("DOMContentLoaded", () => {
    atualizarCarrinho();
});


// Chamada inicial
atualizarCarrinho();

// Fun√ß√£o para adicionar produto ao carrinho
function adicionarAoCarrinho(produto) {
    const carrinho = JSON.parse(localStorage.getItem("carrinho")) || [];
    carrinho.push(produto);
    localStorage.setItem("carrinho", JSON.stringify(carrinho));
    atualizarCarrinho(); // atualiza o n√∫mero no header
}

// =========================
// üîπ PRODUTOS
// =========================
async function carregarProdutos() {
    try {
        const res = await fetch('/produto');
        const produtos = await res.json();
        const lista = document.getElementById('lista-produtos');
        lista.innerHTML = '';

        produtos.forEach(p => {
            lista.innerHTML += `
            <div class="produto">
                <img src="${p.imagem_url || 'https://placehold.co/600x400?text=Sem+Imagem'}" alt="${p.nome}">
                <div class="produto-info">
                    <h3>${p.nome}</h3>
                    <span class="preco">R$ ${p.preco}</span>
                    <span class="frete">Frete gr√°tis</span>
                    <button class="btn-ver" onclick='adicionarAoCarrinho(${JSON.stringify(p)})'>
                        Adicionar ao carrinho
                    </button>
                </div>
            </div>
            `;
        });

    } catch (erro) {
        console.error("Erro:", erro);
    }
}

carregarProdutos();
</script>


</body>
</html>
