<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PetMarket - Marketplace Pet</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<style>
 /* CONTAINER GERAL */
.produtos-container {
    max-width: 1300px;
    margin: 60px auto;
    padding: 60px 20px;
    background: #fff;
}

.titulo-produtos {
    font-size: 2.5rem;
    font-weight: 700;
    text-align: center;
    margin-bottom: 40px;
    color: #222;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 12px;
}

.produtos-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
    gap: 30px;
}

.produto {
    background: #fff;
    border-radius: 20px;
    overflow: hidden;
    border: 2px solid #f0f0f0;
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    cursor: pointer;
    box-shadow: 0 5px 20px rgba(0,0,0,0.08);
}

.produto:hover {
    transform: translateY(-10px) scale(1.02);
    box-shadow: 0 15px 40px rgba(102, 126, 234, 0.15);
    border-color: rgba(102, 126, 234, 0.3);
}

.produto img {
    width: 100%;
    height: 220px;
    object-fit: cover;
    background: linear-gradient(135deg, #f5f5f5 0%, #e8e8e8 100%);
    transition: transform 0.4s ease;
}

.produto:hover img {
    transform: scale(1.1);
}

.produto-info {
    padding: 20px;
}

.produto-info h3 {
    font-size: 1.1rem;
    color: #333;
    font-weight: 600;
    height: 50px;
    line-height: 1.3;
    overflow: hidden;
    text-overflow: ellipsis;
    margin-bottom: 10px;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
}

.preco {
    font-size: 1.6rem;
    background: linear-gradient(135deg, #20bf6b 0%, #17a65c 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    font-weight: 700;
    margin-bottom: 8px;
    display: block;
}

.btn-ver {
    display: block;
    width: 100%;
    text-align: center;
    background: linear-gradient(135deg, #20bf6b 0%, #17a65c 100%);
    color: #fff;
    padding: 12px 0;
    border-radius: 12px;
    text-decoration: none;
    font-weight: 600;
    margin-top: 12px;
    transition: all 0.3s ease;
    box-shadow: 0 4px 15px rgba(32, 191, 107, 0.3);
}

.btn-ver:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(32, 191, 107, 0.4);
}

.frete {
    font-size: .85rem;
    color: #00bb2d;
    font-weight: 600;
    margin-bottom: 8px;
    display: flex;
    align-items: center;
    gap: 5px;
}

.frete::before {
    content: '‚úì';
    background: #00bb2d;
    color: white;
    border-radius: 50%;
    width: 18px;
    height: 18px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    font-size: 12px;
    font-weight: bold;
}

.logouBtn {
    color: #00bb2d;
}

.carrinho {
    font-size: 22px; 
    cursor: pointer; 
    position: relative;
    color: #444;
    transition: all 0.3s ease;
    padding: 8px 12px;
    border-radius: 8px;
    text-decoration: none;
    display: flex;
    align-items: center;
}

.carrinho:hover {
    color: #667eea;
    background: rgba(102, 126, 234, 0.1);
}

.numero-carrinho {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white; 
    font-size: 11px; 
    font-weight: 700;
    padding: 3px 7px; 
    border-radius: 50%; 
    position: absolute; 
    top: 2px; 
    right: 2px;
    min-width: 20px;
    text-align: center;
    box-shadow: 0 2px 8px rgba(102, 126, 234, 0.4);
    animation: pulse 2s infinite;
}

@keyframes pulse {
    0%, 100% {
        transform: scale(1);
    }
    50% {
        transform: scale(1.1);
    }
}

@media (max-width: 768px) {
    .hero-content h1 {
        font-size: 2.2rem;
    }
    
    .hero-content p {
        font-size: 1.1rem;
    }
    
    .hero {
        height: 50vh;
        min-height: 400px;
    }
    
    .navbar nav a span {
        display: none;
    }
    
    .categorias {
        padding: 50px 20px;
    }
    
    .card {
        width: 100%;
        max-width: 280px;
    }
    
    .produto img {
        height: 160px;
    }
    
    .titulo-produtos {
        font-size: 1.8rem;
    }
    
    .produtos-container {
        padding: 40px 20px;
    }
}
</style>

<body>

    <!-- Navbar -->
    <header class="navbar">
        <div class="logo">
            <i class="fas fa-paw"></i> PetMarket
        </div>
        <div>
            <span id="areaUsuario" style="display:none; font-weight:bold; color:rgb(0, 0, 0); margin-right:15px;">
                <i class="fas fa-user"></i> <span id="nomeUsuario"></span>
            </span>
        </div>
        <nav>
            <a href="index.html"><i class="fas fa-home"></i> Home</a>
            <a href="produtos.html"><i class="fas fa-box"></i> Produtos</a>
            <a href="servico.html"><i class="fas fa-concierge-bell"></i> Servi√ßos</a>
            <a href="carrinho.html" id="cart" class="carrinho">
                <i class="fas fa-shopping-cart"></i>
                <span id="cartCount" class="numero-carrinho">0</span>
            </a>
            <button id="logoutBtn" class="btn-login">
                <i class="fas fa-sign-out-alt"></i> Sair
            </button>
            <a href="login_cliente.html" class="btn-login" id="btnLogin">
                <i class="fas fa-sign-in-alt"></i> Entrar
            </a>
        </nav>
    </header>

    <!-- Banner -->
    <section class="hero">
        <div class="hero-overlay"></div>
        <div class="hero-content">
            <h1>O marketplace ideal para cuidar do seu pet <i class="fas fa-heart"></i></h1>
            <p>Encontre petshops, agende servi√ßos e compre produtos em um s√≥ lugar.</p>
        </div>
    </section>

    <!-- Categorias -->
    <section class="categorias">
        <h2><i class="fas fa-th-large"></i> Categorias</h2>

        <div class="cards">
            <div class="card" onclick="window.location.href='servico.html'" style="cursor: pointer;">
                <div class="card-icon">
                    <i class="fas fa-concierge-bell"></i>
                </div>
                <h3>Servi√ßos</h3>
            </div>

            <div class="card" onclick="window.location.href='produtos.html?categoria=higiene'" style="cursor: pointer;">
                <div class="card-icon">
                    <i class="fas fa-spa"></i>
                </div>
                <h3>Cosm√©ticos</h3>
            </div>

            <div class="card" onclick="window.location.href='produtos.html?categoria=ra√ß√£o'" style="cursor: pointer;">
                <div class="card-icon">
                    <i class="fas fa-bowl-food"></i>
                </div>
                <h3>Ra√ß√µes</h3>
            </div>

            <div class="card" onclick="window.location.href='produtos.html?categoria=acess√≥rio'" style="cursor: pointer;">
                <div class="card-icon">
                    <i class="fas fa-tshirt"></i>
                </div>
                <h3>Acess√≥rios</h3>
            </div>
        </div>
    </section>

    <!-- Produtos -->
    <section class="produtos-container">
        <h2 class="titulo-produtos">Produtos em destaque</h2>

        <div class="produtos-grid" id="lista-produtos"></div>
    </section>

    <footer class="footer">
        <div class="footer-container">
            <div class="footer-logo">
                <div class="logo">üêæ PetMarket</div>
            </div>
            <div class="footer-info">
                <p>¬© Copyright 2025 ‚Äì PetMarket ‚Äì Todos os direitos reservados PetMarket Servi√ßos Digitais S.A.</p>
                <p>CNPJ 12.345.678/0001-90 / Rua Ceara, n¬∫ 1200, Bairro Centro, Imperatriz/MA ‚Äì CEP 01.234-567</p>
            </div>
            <div class="footer-links">
                <a href="#">Termos e condi√ß√µes de uso</a>
                <a href="#">C√≥digo de conduta</a>
                <a href="#">Privacidade</a>
                <a href="#">Dicas de seguran√ßa</a>
            </div>
        </div>
    </footer>

<script>
// =========================
// üîπ CONTROLE DE LOGIN / LOGOUT
// =========================
const nomeCliente = localStorage.getItem("cliente_nome");
const areaUsuario = document.getElementById("areaUsuario");
const nomeUsuario = document.getElementById("nomeUsuario");
const btnLogin = document.getElementById("btnLogin");
const logoutBtn = document.getElementById("logoutBtn");

if (nomeCliente) {
    areaUsuario.style.display = "inline-block";
    nomeUsuario.textContent = nomeCliente;

    btnLogin.style.display = "none";
    logoutBtn.style.display = "inline-block";
} else {
    areaUsuario.style.display = "none"; 
    logoutBtn.style.display = "none"; 
    btnLogin.style.display = "inline-block";
}

logoutBtn.addEventListener("click", () => {
    localStorage.clear();
    window.location.reload();
});

// =========================
// üîπ CARRINHO
// =========================
async function atualizarCarrinho() {
    const token = localStorage.getItem("token_cliente");
    if (!token) {
        document.getElementById("cartCount").textContent = 0;
        return;
    }

    try {
        const res = await fetch("http://localhost:3000/carrinho", {
            headers: {
                "Authorization": "Bearer " + token
            }
        });
        const data = await res.json();

        if (res.ok) {
            // quantidade total de itens
            document.getElementById("cartCount").textContent = data.quantidade_itens;
        } else {
            document.getElementById("cartCount").textContent = 0;
        }

    } catch (err) {
        console.error("Erro ao atualizar carrinho:", err);
        document.getElementById("cartCount").textContent = 0;
    }
}
document.addEventListener("DOMContentLoaded", () => {
    atualizarCarrinho();
});


// Chamada inicial
atualizarCarrinho();

// Fun√ß√£o para adicionar produto ao carrinho
function adicionarAoCarrinho(produto) {
    const carrinho = JSON.parse(localStorage.getItem("carrinho")) || [];
    carrinho.push(produto);
    localStorage.setItem("carrinho", JSON.stringify(carrinho));
    atualizarCarrinho(); // atualiza o n√∫mero no header
}

// =========================
// üîπ PRODUTOS
// =========================
async function carregarProdutos() {
    try {
        const res = await fetch('/produto');
        const produtos = await res.json();
        const lista = document.getElementById('lista-produtos');
        lista.innerHTML = '';

        produtos.forEach(p => {
            lista.innerHTML += `
            <div class="produto" onclick="window.location.href = '/ver_produto.html?id=${p.id_produto}'">
                
                <img src="${p.imagem_url || 'https://placehold.co/600x400?text=Sem+Imagem'}" alt="${p.nome}">
                <div class="produto-info">
                    <h3>${p.nome}</h3>
                    <span class="preco">R$ ${p.preco}</span>
                    <span class="frete">Frete gr√°tis</span>
                    <button class="btn-ver" onclick="window.location.href = '/ver_produto.html?id=${p.id_produto}'">
                        Ver Produto
                    </button>
                </div>
            </div>
            `;
        });

    } catch (erro) {
        console.error("Erro:", erro);
    }
}

carregarProdutos();
</script>


</body>
</html>
